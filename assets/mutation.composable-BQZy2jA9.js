var w=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var i=(e,t,s)=>(w(e,t,"read from private field"),s?s.call(e):t.get(e)),v=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},y=(e,t,s,r)=>(w(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s);var g=(e,t,s)=>(w(e,t,"access private method"),s);import{S as Q,L as U,M as x,N as I,O as L,b as C,P,Q as T,T as $,U as A,X as j,Y as D,Z as H,$ as _,g as F,a0 as K,E as N}from"./index-E1lsH67L.js";import{u as k}from"./useQueryClient-Ct9uGIH0.js";var f,m,a,l,O,E,M,S,R,X=(R=class extends Q{constructor(t,s){super();v(this,O);v(this,M);v(this,f,void 0);v(this,m,void 0);v(this,a,void 0);v(this,l,void 0);y(this,f,t),this.setOptions(s),this.bindMethods(),g(this,O,E).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const s=this.options;this.options=i(this,f).defaultMutationOptions(t),U(this.options,s)||i(this,f).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,a),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&x(s.mutationKey)!==x(this.options.mutationKey)?this.reset():((r=i(this,a))==null?void 0:r.state.status)==="pending"&&i(this,a).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=i(this,a))==null||t.removeObserver(this)}onMutationUpdate(t){g(this,O,E).call(this),g(this,M,S).call(this,t)}getCurrentResult(){return i(this,m)}reset(){var t;(t=i(this,a))==null||t.removeObserver(this),y(this,a,void 0),g(this,O,E).call(this),g(this,M,S).call(this)}mutate(t,s){var r;return y(this,l,s),(r=i(this,a))==null||r.removeObserver(this),y(this,a,i(this,f).getMutationCache().build(i(this,f),this.options)),i(this,a).addObserver(this),i(this,a).execute(t)}},f=new WeakMap,m=new WeakMap,a=new WeakMap,l=new WeakMap,O=new WeakSet,E=function(){var s;const t=((s=i(this,a))==null?void 0:s.state)??I();y(this,m,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},M=new WeakSet,S=function(t){L.batch(()=>{var s,r,u,n,b,d,o,h;if(i(this,l)&&this.hasListeners()){const c=i(this,m).variables,p=i(this,m).context;(t==null?void 0:t.type)==="success"?((r=(s=i(this,l)).onSuccess)==null||r.call(s,t.data,c,p),(n=(u=i(this,l)).onSettled)==null||n.call(u,t.data,null,c,p)):(t==null?void 0:t.type)==="error"&&((d=(b=i(this,l)).onError)==null||d.call(b,t.error,c,p),(h=(o=i(this,l)).onSettled)==null||h.call(o,void 0,t.error,c,p))}this.listeners.forEach(c=>{c(i(this,m))})})},R);function Y(e,t){const s=t||k(),r=C(()=>s.defaultMutationOptions(P(e))),u=new X(s,r.value),n=T(u.getCurrentResult()),b=u.subscribe(h=>{$(n,h)}),d=(h,c)=>{u.mutate(h,c).catch(()=>{})};A(r,()=>{u.setOptions(r.value)}),j(()=>{b()});const o=D(H(n));return A(()=>n.error,h=>{if(h&&_(r.value.throwOnError,[h]))throw h}),{...o,mutate:d,mutateAsync:n.mutate,reset:n.reset}}function G(){const{t:e}=F(),t=N();function s(r){var u;if(K.isAxiosError(r)){const{response:n}=r;t.error({description:((u=n==null?void 0:n.data)==null?void 0:u.message)??e("error.default_error.description"),title:e("error.default_error.title")});return}throw r}return{show:s}}function J({queryFn:e,queryKeysToInvalidate:t}){const s=k(),{data:r,isPending:u,mutateAsync:n}=Y({mutationFn:e,onSuccess:async d=>{await Promise.all(t.map(o=>{if("key"in o&&!("params"in o))return console.log(`[CACHE] Invalidating \`${o.key}\``),s.invalidateQueries({queryKey:[o.key],refetchType:"active"});if("key"in o&&"params"in o){const h=Object.values(o.params).map(p=>typeof p=="function"?p(d):p),c=[o.key,...Object.values(h)];return console.log(`[CACHE] Invalidating \`${c}\``),s.invalidateQueries({exact:!0,queryKey:c})}return s.invalidateQueries()}))}});async function b(d){return await n(d)}return{data:C(()=>r.value),execute:b,isLoading:C(()=>u.value)}}export{G as a,J as u};
