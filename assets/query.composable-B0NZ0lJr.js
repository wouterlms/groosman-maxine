var K=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var s=(i,t,e)=>(K(i,t,"read from private field"),e?e.call(i):t.get(i)),c=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},d=(i,t,e,r)=>(K(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e);var p=(i,t,e)=>(K(i,t,"access private method"),e);import{S as St,L as q,aj as Ct,ak as dt,al as ft,am as wt,an as Qt,ao as It,ap as pt,O as Dt,b as I,P as Et,Q as Ut,U as Y,T as bt,X as Ft,$ as vt,Y as Lt,Z as Tt,aq as Mt}from"./index-CGlgPuEt.js";import{u as Pt}from"./useQueryClient-ylb1_Lpr.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[t]="bd927991-ed81-4733-a8fe-b3dab741407f",i._sentryDebugIdIdentifier="sentry-dbid-bd927991-ed81-4733-a8fe-b3dab741407f")}catch{}})();var v,h,x,b,D,T,O,A,M,P,E,U,Q,j,F,k,W,tt,B,et,V,st,z,it,N,rt,$,at,X,nt,Z,Rt,mt,jt=(mt=class extends St{constructor(t,e){super();c(this,F);c(this,W);c(this,B);c(this,V);c(this,z);c(this,N);c(this,$);c(this,X);c(this,Z);c(this,v,void 0);c(this,h,void 0);c(this,x,void 0);c(this,b,void 0);c(this,D,void 0);c(this,T,void 0);c(this,O,void 0);c(this,A,void 0);c(this,M,void 0);c(this,P,void 0);c(this,E,void 0);c(this,U,void 0);c(this,Q,void 0);c(this,j,new Set);this.options=e,d(this,v,t),d(this,O,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,h).addObserver(this),yt(s(this,h),this.options)?p(this,F,k).call(this):this.updateResult(),p(this,z,it).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ot(s(this,h),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ot(s(this,h),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,p(this,N,rt).call(this),p(this,$,at).call(this),s(this,h).removeObserver(this)}setOptions(t,e){const r=this.options,o=s(this,h);if(this.options=s(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");p(this,X,nt).call(this),s(this,h).setOptions(this.options),r._defaulted&&!q(this.options,r)&&s(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,h),observer:this});const a=this.hasListeners();a&&gt(s(this,h),o,this.options,r)&&p(this,F,k).call(this),this.updateResult(e),a&&(s(this,h)!==o||this.options.enabled!==r.enabled||this.options.staleTime!==r.staleTime)&&p(this,W,tt).call(this);const l=p(this,B,et).call(this);a&&(s(this,h)!==o||this.options.enabled!==r.enabled||l!==s(this,Q))&&p(this,V,st).call(this,l)}getOptimisticResult(t){const e=s(this,v).getQueryCache().build(s(this,v),t),r=this.createResult(e,t);return kt(this,r)&&(d(this,b,r),d(this,T,this.options),d(this,D,s(this,h).state)),r}getCurrentResult(){return s(this,b)}trackResult(t,e){const r={};return Object.keys(t).forEach(o=>{Object.defineProperty(r,o,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(o),e==null||e(o),t[o])})}),r}trackProp(t){s(this,j).add(t)}getCurrentQuery(){return s(this,h)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,v).defaultQueryOptions(t),r=s(this,v).getQueryCache().build(s(this,v),e);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,e))}fetch(t){return p(this,F,k).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,b)))}createResult(t,e){var lt;const r=s(this,h),o=this.options,a=s(this,b),l=s(this,D),y=s(this,T),C=t!==r?t.state:s(this,x),{state:m}=t;let n={...m},u=!1,f;if(e._optimisticResults){const g=this.hasListeners(),J=!g&&yt(t,e),Ot=g&&gt(t,r,e,o);(J||Ot)&&(n={...n,...It(m.data,t.options)}),e._optimisticResults==="isRestoring"&&(n.fetchStatus="idle")}let{error:w,errorUpdatedAt:_,status:R}=n;if(e.select&&n.data!==void 0)if(a&&n.data===(l==null?void 0:l.data)&&e.select===s(this,A))f=s(this,M);else try{d(this,A,e.select),f=e.select(n.data),f=pt(a==null?void 0:a.data,f,e),d(this,M,f),d(this,O,null)}catch(g){d(this,O,g)}else f=n.data;if(e.placeholderData!==void 0&&f===void 0&&R==="pending"){let g;if(a!=null&&a.isPlaceholderData&&e.placeholderData===(y==null?void 0:y.placeholderData))g=a.data;else if(g=typeof e.placeholderData=="function"?e.placeholderData((lt=s(this,P))==null?void 0:lt.state.data,s(this,P)):e.placeholderData,e.select&&g!==void 0)try{g=e.select(g),d(this,O,null)}catch(J){d(this,O,J)}g!==void 0&&(R="success",f=pt(a==null?void 0:a.data,g,e),u=!0)}s(this,O)&&(w=s(this,O),f=s(this,M),_=Date.now(),R="error");const L=n.fetchStatus==="fetching",G=R==="pending",H=R==="error",ut=G&&L,ct=f!==void 0;return{status:R,fetchStatus:n.fetchStatus,isPending:G,isSuccess:R==="success",isError:H,isInitialLoading:ut,isLoading:ut,data:f,dataUpdatedAt:n.dataUpdatedAt,error:w,errorUpdatedAt:_,failureCount:n.fetchFailureCount,failureReason:n.fetchFailureReason,errorUpdateCount:n.errorUpdateCount,isFetched:n.dataUpdateCount>0||n.errorUpdateCount>0,isFetchedAfterMount:n.dataUpdateCount>C.dataUpdateCount||n.errorUpdateCount>C.errorUpdateCount,isFetching:L,isRefetching:L&&!G,isLoadingError:H&&!ct,isPaused:n.fetchStatus==="paused",isPlaceholderData:u,isRefetchError:H&&ct,isStale:ht(t,e),refetch:this.refetch}}updateResult(t){const e=s(this,b),r=this.createResult(s(this,h),this.options);if(d(this,D,s(this,h).state),d(this,T,this.options),s(this,D).data!==void 0&&d(this,P,s(this,h)),q(r,e))return;d(this,b,r);const o={},a=()=>{if(!e)return!0;const{notifyOnChangeProps:l}=this.options,y=typeof l=="function"?l():l;if(y==="all"||!y&&!s(this,j).size)return!0;const S=new Set(y??s(this,j));return this.options.throwOnError&&S.add("error"),Object.keys(s(this,b)).some(C=>{const m=C;return s(this,b)[m]!==e[m]&&S.has(m)})};(t==null?void 0:t.listeners)!==!1&&a()&&(o.listeners=!0),p(this,Z,Rt).call(this,{...o,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&p(this,z,it).call(this)}},v=new WeakMap,h=new WeakMap,x=new WeakMap,b=new WeakMap,D=new WeakMap,T=new WeakMap,O=new WeakMap,A=new WeakMap,M=new WeakMap,P=new WeakMap,E=new WeakMap,U=new WeakMap,Q=new WeakMap,j=new WeakMap,F=new WeakSet,k=function(t){p(this,X,nt).call(this);let e=s(this,h).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Ct)),e},W=new WeakSet,tt=function(){if(p(this,N,rt).call(this),dt||s(this,b).isStale||!ft(this.options.staleTime))return;const e=wt(s(this,b).dataUpdatedAt,this.options.staleTime)+1;d(this,E,setTimeout(()=>{s(this,b).isStale||this.updateResult()},e))},B=new WeakSet,et=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,h)):this.options.refetchInterval)??!1},V=new WeakSet,st=function(t){p(this,$,at).call(this),d(this,Q,t),!(dt||this.options.enabled===!1||!ft(s(this,Q))||s(this,Q)===0)&&d(this,U,setInterval(()=>{(this.options.refetchIntervalInBackground||Qt.isFocused())&&p(this,F,k).call(this)},s(this,Q)))},z=new WeakSet,it=function(){p(this,W,tt).call(this),p(this,V,st).call(this,p(this,B,et).call(this))},N=new WeakSet,rt=function(){s(this,E)&&(clearTimeout(s(this,E)),d(this,E,void 0))},$=new WeakSet,at=function(){s(this,U)&&(clearInterval(s(this,U)),d(this,U,void 0))},X=new WeakSet,nt=function(){const t=s(this,v).getQueryCache().build(s(this,v),this.options);if(t===s(this,h))return;const e=s(this,h);d(this,h,t),d(this,x,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},Z=new WeakSet,Rt=function(t){Dt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,b))}),s(this,v).getQueryCache().notify({query:s(this,h),type:"observerResultsUpdated"})})},mt);function _t(i,t){return t.enabled!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function yt(i,t){return _t(i,t)||i.state.data!==void 0&&ot(i,t,t.refetchOnMount)}function ot(i,t,e){if(t.enabled!==!1){const r=typeof e=="function"?e(i):e;return r==="always"||r!==!1&&ht(i,t)}return!1}function gt(i,t,e,r){return(i!==t||r.enabled===!1)&&(!e.suspense||i.state.status!=="error")&&ht(i,e)}function ht(i,t){return t.enabled!==!1&&i.isStaleByTime(t.staleTime)}function kt(i,t){return!q(i.getCurrentResult(),t)}function xt(i,t,e){const r=e||Pt(),o=I(()=>{const u=Et(t);typeof u.enabled=="function"&&(u.enabled=u.enabled());const f=r.defaultQueryOptions(u);return f._optimisticResults=r.isRestoring.value?"isRestoring":"optimistic",f}),a=new i(r,o.value),l=Ut(a.getCurrentResult());let y=()=>{};Y(r.isRestoring,u=>{u||(y(),y=a.subscribe(f=>{bt(l,f)}))},{immediate:!0});const S=()=>{a.setOptions(o.value),bt(l,a.getCurrentResult())};Y(o,S),Ft(()=>{y()});const C=(...u)=>(S(),l.refetch(...u)),m=()=>new Promise((u,f)=>{let w=()=>{};const _=()=>{if(o.value.enabled!==!1){a.setOptions(o.value);const R=a.getOptimisticResult(o.value);R.isStale?(w(),a.fetchOptimistic(o.value).then(u,L=>{vt(o.value.throwOnError,[L,a.getCurrentQuery()])?f(L):u(a.getCurrentResult())})):(w(),u(R))}};_(),w=Y(o,_)});Y(()=>l.error,u=>{if(l.isError&&!l.isFetching&&vt(o.value.throwOnError,[u,a.getCurrentQuery()]))throw u});const n=Lt(Tt(l));for(const u in l)typeof l[u]=="function"&&(n[u]=l[u]);return n.suspense=m,n.refetch=C,n}function At(i,t){return xt(jt,i,t)}function Nt({isEnabled:i,queryFn:t,queryKey:e,staleTime:r=0}){const{data:o,error:a,isError:l,isLoading:y,isSuccess:S,refetch:C,suspense:m}=At({enabled:i,placeholderData:w=>w,queryFn:t,queryKey:I(()=>n()),staleTime:r});function n(){return typeof e=="object"&&"params"in e?[e.key,...Object.values(Mt(e.params))]:[e.key]}async function u(){await m()}async function f(){await C()}return{data:I(()=>o.value??null),error:I(()=>a.value),isError:I(()=>l.value),isLoading:I(()=>y.value),isSuccess:I(()=>S.value),refetch:f,suspense:u}}export{Nt as u};
